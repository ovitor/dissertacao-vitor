\chapter{Proposta}\label{cap:proposta}

Neste capítulo serão abordadas as etapas que constituem a estrutura geral do
sistema de informática voltado para o atendimento de paciente no espaço domiciliar. 
Sua descrição é realizada na primeira seção. O TV-Health, parte integrante da 
solução, tem suas características apresentadas no item \ref{sec:tv-health}.

\section{Descrição de cenários}

A figura tal representa, de maneira generalista, o cenário base para a aplicação
da solução THECA. Nela podem ser verificados 3 ambientes, o ambiente A, diz
respeito ao domicílio do paciente. Já o ambiente B, diz respeito aos atores
móveis, tais como, equipe de saúde, parentes, amigos etc. O ambiente C
representa os serviços disponibilizados pela solução.

\figurasimples{cenarios}{Visão geral dos cenários abordados.}{14cm}

\subsection{Cenário A} \label{subsec:cenario-a}

O cenário A representa o domicílio do usuário, seus atores locais (paciente,
visitantes e cuidador e/ou parentes), os equipamentos responsáveis por 
realizar a aquisição dos dados, o \stb[] (\textit{gateway}), a televisão e outros
dispositivos capazes de apresentar dados e informações úteis para a assistência
domiciliar à saúde. 

Neste ambiente, o ator principal é o paciente, o monitoramento constante 
proporcionado pela tecnologia nos permite acompanhar com mais clareza a situação
do doente. A partir do monitoramento é possível avisar, por exemplo, à equipe
de saúde (cenário B) uma leitura de sinais vitais. Nesse sentido, é possível 
também, lembrar ao paciente, a necessidade de tomar determinado remédio em um
horário específico.

O cuidador também tem papel importante na recuperação ou no cotidiano do 
paciente. Portanto, a tecnologia inserida neste ambiente tem função de ajudar
este ator. O sistema pode enviar mensagens no intuito de auxiliar o cuidador no
que concerne ao tratamento para com o paciente ou idoso, informando como lidar
com determinada situação ou simplesmente relembrá-lo da agenda diária do 
paciente, como por exemplo, atividade física, encontro com amigos etc.

Os familiares e visitantes, figuras constantes em um ambiente domiciliar, também
podem ser informados sobre um fato novo na agenda do doente, algo inusitado ou 
ainda uma situação de urgência/emergência.

Nesse sentido, podemos inserir no ambiente domiciliar, um conjunto de
dispositivos dotados de sensores com o intuito de captar eventos no domicílio. É
possível a utilização de sistemas para captar os sinais vitais do paciente, tais
como nível de oxigênio no corpo, batimentos cardíacos, temperatura corporal etc.
Outros tipos de sensores podem ser implantados para captar informações do
ambiente, disponibilizando assim, informações de contexto para o sistema,  tais
como, ruído sonoro nos cômodos, presença dos atores no domicílio, temperatura
ambiente etc. Estas duas categorias caracterizam um  ambiente com tecnologia de
Internet das coisas (\textit{Internet of Things  - IoT}).

O STB, equipamento que tinha como principal função, o recebimento do sinal
televisivo, seu processamento e  exibição, ganha novas funcionalidades a partir
do momento em que, aumentamos seu  poder de processamento e, o conectamos à 
Internet. Os dados coletados pelos sensores são, então, repassados ao STB,
que os processa, os apresenta através da tela do televisor ou ainda através de
\smartphones[] conectados ao sistema.


\subsection{Cenário B} \label{subsec:cenario-b}

Os atores externos utilizam o sistema por meio das interfaces web, das mensagens
via celular

\section{Descrição da solução}
\label{sec:descricao-solucao}

A arquitetura proposta soluciona o problema relatado na seção  
\ref{sec:descricao-problema}. Ela é composta de 3 camadas distintas mas que
se comunicam entre sí. As camadas são, (1) ``Camada de aquisição de dados''
responsável por adquirir os dados brutos dos sensores, (2) ``Camada de Gerência 
e Inteligência'' responsável por tratar os dados e inferir e (3) ``Camada de 
Apresentação de informações'' - responsável por apresentar os dados nos mais
diversos dispositivos. A figura \ref{fig:arquitetura-v2} representa graficamente
a arquitetura proposta.

\figurasimples{arquitetura-v2}{Visão geral arquitetural da solução}{12cm}


A ``Camada de aquisição de dados'' representa toda a parte de baixo nível da
solução.

Já a ``Camada de Gerência e Inferência'' trata os dados processados na camada
de aquisição de dados, realizando inferências com modelos ontológicos e 
persistindo-os em base de dados.

Por fim, a ``Camada de apresentação'' se encarrega de apresentar os dados brutos
ou as informações processadas nos dispositivos conectados à plataforma.

% \figurasimples{tela-principal-dado}
% {Tela principal do módulo \textit{service.dado}}{14cm}

\subsubsection{Módulo \textit{service.panicbutton}}\label{subsubsec:panicbutton}

O módulo \textit{service.panicbutton} tem como objetivo, permitir que o usuário
utilize o controle remoto para reportar um momento que precisa de ajuda 
emergencial. Ao acionar a tecla reservada para tal função, o sistema percebe e
prepara um conjunto de tarefas a serem executadas. Dentre elas, o envio de 
mensagens via (1) Serviço de Mensagem Simples (SMS) e (2) serviços de comunicação
pela Internet (como por exemplo o aplicativo \textit{Telegram}) para parentes, 
amigos, cuidador e a equipe médica que o acompanha. Além de entrar em contato
com o serviço de urgência e emergência.

Em seguida, o aplicativo exibe uma notificação na tela da televisão no intuito
de acalmá-lo. A figura \ref{fig:notificacao-botao-de-panico} exibe a mensagem 
tranquilizando o usuário.

% % \figurasimples{notificacao-botao-de-panico}
% {Mensagem na tela tranquilizando o usuário.}{14cm}

\section{Visão de Engenharia} \label{sec:visao-engenharia}

A figura \ref{fig:arquitetura} representa a visão de engenharia da arquitetura
proposta. Ela tem como ponto principal a utilização de um \stb[], quando se
conectam a ele sensores  implantados no ambiente, sensores de dispositivos como
\smartphones[] e  \smartwatches[] do paciente e do cuidador, e sensores médicos
do doente.

\figurasimples{arquitetura}{Visão de engenharia da arquitetura proposta.}{12cm}

Esse processo é composto de três momentos distintos, mas  interligados, no qual
o primeiro é relativo à aquisição de dados do ambiente e do paciente, e a
transmissão desses dados ao STB. O segundo diz respeito ao processamento dos
dados brutos. O terceiro momento o envio dos dados processados para a plataforma
NextSAÚDE.

Neste sentido, os sensores gerais, relativos ao ambiente domiciliar, coletam
informações como  temperatura e umidade da residência, qualidade do ar e
localização do paciente ou cuidador nos cômodos. A partir desses dados é
possível dizer ao software se determinado espaço está muito quente, se a
qualidade do ar não está favorável à melhoria do paciente etc. Dados extraídos
de celulares, como a localização, também cooperam com o contexto, a exemplo da
informação proveniente do celular do cuidador que informa, à equipe médica ou
aos parentes, se este está junto ao paciente.

Já os sensores médicos têm como função principal coletar os sinais vitais do
paciente (pressão arterial, frequência cardíaca, níveis de oxigênio no sangue
etc). Em ambos os casos - sensores gerais e sensores médicos -, as informações
coletadas pelos dispositivos repassam  esses dados para o STB, seja através de
interfaces com tecnologia  \textit{Bluetooth}, \textit{NFC} ou \textit{Wi-Fi}.

Essa quantidade de dados enviada ao STB deverá então ser processada e encaminhada
para a plataforma NextSaúde. O processamento é referente ao tratamento do dado
bruto recebido e a tradução para o padrão OpenEHR entendido pela plataforma
NextSaúde. Em seguida a transmissão dos dados é feita através de uma
arquitetura  cliente/servidor. Já no sistema na nuvem, o dado relacionado ao
paciente é extraído e persistido.

Para permitir ao STB tomar decisões no âmbito domiciliar, parte dos dados
referentes ao contexto são tratados e processados diretamente no equipamento.
Já os dados referentes aos sinais vitais são enviados para plataforma. Dessa 
maneira, ocorre um processamento nos dados para tomada de decisões a nível
clínico, por exemplo, indicar uma consulta na especialidade cardiológica.

Pelo exposto, uma funcionalidade importante do sistema é a geração de alertas e
notificações para o paciente e o cuidador. Os atores recebem as notificações
através da tela da televisão conectada ao STB. Para esse sistema, dois tipos de
alertas foram desenvolvidos: o tipo \textit{pop-up} e o caixa de diálogo.
Além disso, a partir das informações de contexto, o sistema pode decidir
entregar a mensagem não na tela da televisão e sim no \smartphone.

\section{Cenários de uso} \label{sec:cenarios-de-uso}

Os seguintes cenários de uso exemplificam a aplicação da tecnologia e em quais
momentos ela é mais requerida.

\subsection{Notificações}\label{subsec:notificacoes}

Luisa, aposentada, 75 anos, vive sozinha em seu apartamento, passa boa parte do
seu dia na sala de estar, lendo ou assistindo à televisão. Sua rotina muda um
pouco quando seus filhos a visitam nos finais de semana. Infelizmente, Luisa
sofre de uma doença crônica e seu médico recomenda caminhada uma vez ao dia,
durante 30 minutos. Além disso, foi prescrito à Luisa alguns medicamentos
necessários para evitar as dores - cada um deles deveria ser ingerido em
horários específicos.

Para que Luisa não ficasse sozinha tanto tempo, seus filhos pediram à vizinha
que checasse sua condição de tempos em tempos, fazendo com que Luisa agora tivesse uma
espécie de cuidador informal. A função do cuidador informal seria de acompanhar
Luisa na caminhada e recordá-la de tomar seus remédios.

Através do sistema embarcado acoplado à televisão e conectado à Internet, é
possível enviar à Luisa avisos e notificações lembrando de suas atividades
diárias - como por exemplo, a caminhada de 30 minutos recomendada pelo
médico além do medicamento a ser ingerido.

Portanto, este cenário de uso exemplifica uma aplicação prática do sistema de
notificação e alertas desenvolvido para compor o trabalho.

\subsection{DADO}\label{subsec:dado}

Roberto é autônomo e trabalha em casa consertando televisores, mora com sua
filha de 16 anos. Apesar do constante contato com os televisores, em seu momento
de descanso, assiste aos seus programas favoritos.

Certo dia, Roberto não se sente bem e se deita, tendo instalado à sua televisão
o set-top box com as aplicações tv-health, ele conta com a disponibilidade da
aplicação DADO. Em determinado momento, acessa a aplicação "Não está se sentindo
bem?" através do controle remoto, selecionando-a do menu "Sua Saúde". Através
dela, verifica um conjunto de imagens, cada uma exemplificando um sintoma.
Usando o controle remoto, seleciona os sintomas que melhor exemplificam o que
está sentindo. Essa informação é processada e, em seguida, a aplicação apresenta
uma notificação contendo uma segunda opinião, informando também a necessidade de
se apresentar à um médico.

É possível ainda que a aplicação sugira, em determinados casos, procedimentos a
serem realizados no paciente, momento em que a filha de Roberto teria o papel de
cuidadora informal ao realizar tais procedimentos. A aplicação guiaria o
cuidador informal em um processo passo a passo. Neste cenário,  percebe-se a
importância de contar com um dispositivo que auxilie o cuidador e o paciente em
situações de risco à saúde.

\subsection{Botão de Pânico}\label{subsec:botao-panico}

Maria é dona de casa e passa suas manhãs organizando e limpando a casa. Apesar
de todo esse apreço pela casa, Maria não se cuida e, além de ser hipertensa,
esquece de tomar seu remédio em algumas ocasiões, tamanho é o seu desleixo.

Certa manhã, após preparar o almoço, Maria senta-se para assistir televisão -
que conta com o set-top box com as aplicações tv-health. Passado
alguns minutos, ela sente uma forte dor no peito seguido por um desconforto no
braço esquerdo. Neste momento, Maria certa de que precisa de ajuda, aciona no
controle remoto o "botão de pânico".

A aplicação percebe o acionamento e toma algumas medidas, tais como, enviar
mensagens de socorro através de SMS ou através de serviços de mensagens pela
Internet para a equipe médica, para os amigos e familiares, além de entrar em
contato com o serviço médico de urgência. Por fim, a aplicação envia uma
notificação para ser exibida na televisão no sentido de tranquilizar o usuário.

Em determinados casos, é possível, ainda, que a aplicação envie, através de
notificações, sugestões de medidas a serem tomadas enquanto o socorro médico não
chega.
